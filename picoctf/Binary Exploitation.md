# 1. buffer overflow 0

> buffer overflow

## Solution:

- The goal is to intentionally crash the program to make it print the flag. by seeing the source we find out that by giving an input greater than 16 bytes (which is the size of buf2) we create and segmentation overflow and this causes the program to break but the program has a function which runs and handle the breaking and this functions prints our flag.

```
rishi@omenrishi:~$ nc saturn.picoctf.net 50031
Input: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}
```

## Flag:

```
picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}
```

## Concepts learnt:

- We can read the source code to find out possible vulnerability

## Notes:

- We can read the source code to find out possible vulnerability. the buf2 variable on initialize shows that its size is 16 byte. we use that to exploit the code

## Resources:

- no refrence


***

# 2. format string 0

> Format string vulnerabilities

## Solution:

- The goal is to intentionally crash the program to trigger the sigsegv_handler and print the flag, by reading the program we find out that the first input should be greater than 64 in size (since the if condition checks for 2*BUFSIZE and BUFSIZE is 32). if this is true then program calls the serve_bob function. the only option which is greater than 64 in size is the third option because of the %114d which means to add 114 spaces and counts as 114 characters. for the second prompt we need to provide a valid menu option that, when used as a format string, causes a segmentation fault. the only option suitable for this is again the third one because of the %s which breaks the program

```
rishi@omenrishi:~$ nc mimas.picoctf.net 50074
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: Gr%114d_Cheese
Gr                                                                                                           4202954_Cheese
Good job! Patrick is happy! Now can you serve the second customer?
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
Enter your recommendation: Cla%sic_Che%s%steak
ClaCla%sic_Che%s%steakic_Che
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_c8362f05}
```

## Flag:

```
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_c8362f05}
```

## Concepts learnt:

- We can read the source code to find out possible vulnerability

## Notes:

- We can read the source code to find out possible vulnerability. we use string format vulurebility to break the program and run the segfault function which is used to handle the error and this in turn prints our flag.

## Resources:

- googled on how %s worked (%s tells printf to take the next argument from the stackand treat it as a char* and print the string at that memory address. since we didn't provide any arguments, printf will just grab whatever garbage value is currently on the stack and this breaks the program)


***